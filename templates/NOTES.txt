####################################################################
##                 [ğŸ”„] Helm Chart [ğŸ”„]                ##
####################################################################

{{- $projectName := include "project.name" . }}
{{- $releaseName := .Release.Name }}
{{- $namespace := include "project.namespace" . }}
{{- $servicePort := .Values.containerPort }}
{{- $routeEnabled := .Values.enableRoute | default false }}
{{- $hpaEnabled := .Values.enableHPA | default false }}
{{- $pvcEnabled := .Values.enablePVC | default false }}
{{- $replicaCount := .Values.replicas.min }}
{{- $hostSuffix := .Values.hostSuffix }}
{{- $deploymentType := "DeploymentConfig" }}
{{- if eq .Values.apiVersions.deploymentConfig "apps/v1" }}
  {{- $deploymentType = "Deployment" }}
{{- end }}

___________________________________________________________________
ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  ğŸš€  
ğŸ”· InformaÃ§Ãµes de ImplantaÃ§Ã£o:
ğŸ”¹ Nome do Projeto: {{ $projectName }}
ğŸ”¹ Nome da Release: {{ $releaseName }}
ğŸ”¹ Namespace: {{ $namespace }}
ğŸ”¹ Tipo de Deployment: {{ $deploymentType }}
ğŸ”¹ NÃºmero de rÃ©plicas: {{ $replicaCount }}

___________________________________________________________________
ğŸ”· ServiÃ§o:
{{- if .Values.enableService }}
  âœ… Service habilitado na porta: {{ $servicePort }} 
  ğŸ”¹ URL interna: 
  http://{{ $projectName }}.{{ $namespace }}.svc:{{ $servicePort }}
{{ else }}
  âš ï¸ Service: NÃ£o habilitado !!!
{{- end }}

___________________________________________________________________
{{- if $routeEnabled }}
ğŸ”· Rota:
  âœ… URL do Route (externo): 
  http://{{ $projectName }}-{{ $namespace }}.{{ $hostSuffix }}
{{- end }}

___________________________________________________________________
ğŸ”· ConfiguraÃ§Ã£o de Auto Scaling (HPA):
{{- if $hpaEnabled }}
  âœ… HPA habilitado:
  ğŸ”¹ MÃ­nimo de rÃ©plicas: {{ .Values.replicas.min }}
  ğŸ”¹ MÃ¡ximo de rÃ©plicas: {{ .Values.replicas.max }}
  ğŸ”¹ Scale por mÃ©tricas:
    {{- if .Values.metrics.cpu.enabled }}
    ğŸ”¹ CPU Utilization: {{ .Values.metrics.cpu.averageUtilization | default 80 }}%
    {{- end }}
    {{- if .Values.metrics.memory.enabled }}
    ğŸ”¹ Memory Utilization: {{ .Values.metrics.memory.averageUtilization | default 80 }}%
    {{- end }}
{{- else }}
  âš ï¸ HPA: NÃ£o habilitado !!!
{{- end }}

___________________________________________________________________
ğŸ”· Volumes Persistentes (PV e PVC):
{{- if $pvcEnabled }}
  âœ… PVC habilitado:
{{- range .Values.VolumePersistence }}
  ğŸ”¹ Nome do PVC: {{ .name | default $.Values.projectName }}
  ğŸ”¹ Tamanho: {{ .size | default "1Gi" }}
  ğŸ”¹ Modo de acesso: {{ .accessMode | default "ReadWriteMany" }}
  ğŸ”¹ Classe de armazenamento: {{ .storageClassName | default "ocs-storagecluster-cephfs" }}
{{- end }}
{{- else }}
  âš ï¸ PVC: NÃ£o habilitado
{{- end }}

___________________________________________________________________
ğŸ”· Probes:
{{- if .Values.livenessProbe.enabled }}
  âœ… Liveness Probe URI: http://{{ $projectName }}.{{ $namespace }}.svc:{{ .Values.livenessProbe.port | default $servicePort }}{{ .Values.livenessProbe.path | default "/actuator/liveness" }}
{{- else }}
  âš ï¸ Liveness Probe: NÃ£o configurado !!!
{{- end }}

{{- if .Values.readinessProbe.enabled }}
  âœ… Readiness Probe URI: http://{{ $projectName }}.{{ $namespace }}.svc:{{ .Values.readinessProbe.port | default $servicePort }}{{ .Values.readinessProbe.path | default "/actuator/readiness" }}
{{- else }}
  âš ï¸ Readiness Probe: NÃ£o configurado !!!
{{- end }}

___________________________________________________________________
ğŸ”· RECOMENDAÃ‡Ã•ES: ğŸ“ 
{{- $recommendationFound := false }}  

{{- if not .Values.livenessProbe.enabled }}
  ğŸ”„ Recomenda-se configurar o Liveness Probe para monitorar se o container estÃ¡ em um estado vÃ¡lido. Exemplo de configuraÃ§Ã£o âš ï¸:
```
livenessProbe:
  httpGet:
    path: /actuator/liveness
    port: {{ $servicePort }}
  initialDelaySeconds: 50
  timeoutSeconds: 3
```
  {{- $recommendationFound = true }}
{{- end }}

{{- if not .Values.readinessProbe.enabled }}
  ğŸ”„ Recomenda-se configurar o Readiness Probe para verificar se o container estÃ¡ pronto para receber trÃ¡fego. Exemplo de configuraÃ§Ã£o âš ï¸:
```
readinessProbe:
  httpGet:
    path: /actuator/readiness
    port: {{ $servicePort }}
  initialDelaySeconds: 50
  timeoutSeconds: 3
```
  {{- $recommendationFound = true }}
{{- end }}

{{- if eq .Values.apiVersions.deploymentConfig "apps.openshift.io/v1" }}
  ğŸ”„ O recurso DeploymentConfig estÃ¡ sendo depreciado. Por favor, considere a migraÃ§Ã£o para o apps/v1 no arquivo values.yaml âš ï¸:
```
apiVersions:
  deploymentConfig: apps/v1
```
  {{- $recommendationFound = true }}
{{- end }}

{{- if not $recommendationFound }}
  âœ… Tudo estÃ¡ configurado corretamente para o deploy. Nenhuma recomendaÃ§Ã£o necessÃ¡ria. ğŸ˜Šâ˜€ï¸
{{- else }}
  âš ï¸ Voce tem recomendaÃ§Ãµes para aplicar na sua definiÃ§Ã£o de charts. ğŸ¤”ğŸŒ§
     Duvidasâ“, verificar a documentaÃ§Ã£o: 
      ğŸ“ https:// ğŸ“
{{- end }}
###########################################################
ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ  ğŸ    

